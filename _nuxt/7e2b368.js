(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{243:function(t,e,r){"use strict";r.r(e);r(33),r(78),r(34),r(26),r(167),r(81),r(82),r(62),r(15),r(40),r(27),r(41);var o=r(37),n=(r(31),r(5));function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}var l={asyncData:function(t){return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.store,e.abrupt("return",Promise.all([r.dispatch("getCartData")]));case 2:case"end":return e.stop()}}),e)})))()},data:function(){return{couponCode:"",coupon:{},formData:{name:"",sex:"",tel:"",birthday:"",email:"",address:"",payment:"",message:""}}},methods:{getCoupon:function(){var t=this,e="".concat("https://course-ec-api.hexschool.io/api/").concat("6b69171f-d486-488a-beaf-ee85eb21fa24","/ec/coupon/search"),code={code:this.couponCode};this.$axios.post(e,code).then((function(e){t.coupon=e.data.data,t.$swal.fire({position:"top-end",icon:"success",title:"恭喜成功拿到折扣",showConfirmButton:!1,timer:1500})})).catch((function(){t.$swal.fire({position:"top-end",icon:"error",title:"沒有這個折扣碼唷！",showConfirmButton:!1,timer:1500})}))},formSubmit:function(){var t=this,e="".concat("https://course-ec-api.hexschool.io/api/").concat("6b69171f-d486-488a-beaf-ee85eb21fa24","/ec/orders"),r=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},this.formData);this.coupon.enabled&&(r.coupon=this.coupon.code),this.$axios.post(e,r).then((function(e){t.$router.push({path:"/".concat(e.data.data.id),query:{orderId:e.data.data.id}})})).catch((function(){t.$swal.fire({position:"top-end",icon:"error",title:"建立訂單失敗",showConfirmButton:!1,timer:1500})}))}},computed:{cartData:function(){return this.$store.state.cartData},totalMoney:function(){return this.cartData.reduce((function(t,e){return t+e.product.price*e.quantity}),0)}}},m=r(16),component=Object(m.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",{staticClass:"cart-form-wrap"},[r("div",{staticClass:"cart-form"},[r("div",{staticClass:"cart-form-header"},[r("h2",[t._v("訂購人資料")]),t._v(" "),r("router-link",{attrs:{to:"/cart"}},[r("i",{staticClass:"fas fa-angle-left"}),t._v(" 購物車\n        ")])],1),t._v(" "),r("form",{on:{submit:function(e){return e.preventDefault(),t.formSubmit(e)}}},[r("div",{staticClass:"cart-form-split"},[r("div",{staticClass:"item"},[r("label",{attrs:{for:"cartName"}},[t._v("姓名 *")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.name,expression:"formData.name"}],attrs:{type:"text",placeholder:"請輸入姓名",id:"cartName",name:"姓名"},domProps:{value:t.formData.name},on:{input:function(e){e.target.composing||t.$set(t.formData,"name",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"cart-form-radio"},[r("label",{attrs:{for:"cartMale"}},[t._v("先生")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.sex,expression:"formData.sex"}],attrs:{type:"radio",name:"sex",value:"male",id:"cartMale",required:""},domProps:{checked:t._q(t.formData.sex,"male")},on:{change:function(e){return t.$set(t.formData,"sex","male")}}}),t._v(" "),r("label",{attrs:{for:"cartFemale"}},[t._v("小姐")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.sex,expression:"formData.sex"}],attrs:{type:"radio",name:"sex",value:"female",id:"cartFemale",required:""},domProps:{checked:t._q(t.formData.sex,"female")},on:{change:function(e){return t.$set(t.formData,"sex","female")}}})])]),t._v(" "),r("div",{staticClass:"cart-form-split"},[r("div",{staticClass:"item"},[r("label",{attrs:{for:"cartPhone"}},[t._v("聯絡手機 *")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.tel,expression:"formData.tel"}],attrs:{type:"tel",placeholder:"請輸入手機號碼",id:"cartPhone",name:"聯絡電話"},domProps:{value:t.formData.tel},on:{input:function(e){e.target.composing||t.$set(t.formData,"tel",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"item"},[r("label",{attrs:{for:"cartBirth"}},[t._v("生日 *")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.birthday,expression:"formData.birthday"}],attrs:{type:"date",id:"cartBirth"},domProps:{value:t.formData.birthday},on:{input:function(e){e.target.composing||t.$set(t.formData,"birthday",e.target.value)}}})])]),t._v(" "),r("div",{staticClass:"cart-form-whole"},[r("div",{staticClass:"item"},[r("label",{attrs:{for:"cartEmail"}},[t._v("Email *")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.email,expression:"formData.email"}],attrs:{type:"email",id:"cartEmail",name:"Email",placeholder:"請輸入電子郵件"},domProps:{value:t.formData.email},on:{input:function(e){e.target.composing||t.$set(t.formData,"email",e.target.value)}}})])]),t._v(" "),r("div",{staticClass:"cart-form-whole"},[r("div",{staticClass:"item"},[r("label",{attrs:{for:"cartAddress"}},[t._v("地址 *")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.address,expression:"formData.address"}],attrs:{type:"texct",id:"cartAddress",name:"地址",placeholder:"請輸入地址"},domProps:{value:t.formData.address},on:{input:function(e){e.target.composing||t.$set(t.formData,"address",e.target.value)}}})])]),t._v(" "),r("div",{staticClass:"cart-form-whole"},[r("div",{staticClass:"item"},[r("label",{attrs:{for:"cartPurchase"}},[t._v("購買方式 *")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.payment,expression:"formData.payment"}],attrs:{id:"cartPurchase",required:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.formData,"payment",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"",disabled:""}},[t._v("請選擇付款方式")]),t._v(" "),r("option",{attrs:{value:"WebATM"}},[t._v("WebATM")]),t._v(" "),r("option",{attrs:{value:"ATM"}},[t._v("ATM")]),t._v(" "),r("option",{attrs:{value:"Credit"}},[t._v("Credit")]),t._v(" "),r("option",{attrs:{value:"GooglePay"}},[t._v("GooglePay")]),t._v(" "),r("option",{attrs:{value:"ApplePay"}},[t._v("ApplePay")])])])]),t._v(" "),r("div",{staticClass:"cart-form-whole"},[r("div",{staticClass:"item"},[r("label",{attrs:{for:"cartMessage"}},[t._v("備註")]),t._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.message,expression:"formData.message"}],attrs:{id:"cartMessage",rows:"3",placeholder:"歡迎留下備註"},domProps:{value:t.formData.message},on:{input:function(e){e.target.composing||t.$set(t.formData,"message",e.target.value)}}})]),t._v(" "),t._m(0)])])]),t._v(" "),r("div",{staticClass:"cart-info"},[r("p",{staticClass:"cart-info-tips"},[t._v("\n        訂單確認完成後，5~7個工作天內宅配到貨或是通知指定門市取貨。\n      ")]),t._v(" "),r("div",{staticClass:"cart-info-total"},[r("ul",[r("li",[r("h3",[t._v("商品總額")]),t._v(" "),r("span",[t._v("$ "+t._s(t._f("currency")(t.totalMoney)))])]),t._v(" "),r("li",[r("h3",[t._v("折扣碼")]),t._v(" "),r("div",{staticClass:"cart-info-coupon"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],attrs:{type:"text"},domProps:{value:t.couponCode},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getCoupon(e)},input:function(e){e.target.composing||(t.couponCode=e.target.value)}}}),t._v(" "),r("button",{attrs:{type:"button"},on:{click:t.getCoupon}},[t._v("確認")])])]),t._v(" "),r("li",[r("h3",[t._v("折價")]),t._v(" "),t.coupon.percent?r("span",[t._v("\n              -$\n              "+t._s(t._f("currency")(Math.floor(t.totalMoney*(t.coupon.percent/100))))+"\n            ")]):r("span",[t._v("-$ 0")])]),t._v(" "),r("li",[r("h3",[t._v("總計")]),t._v(" "),t.coupon.percent?r("span",[t._v("\n              $\n              "+t._s(t._f("currency")(Math.floor(t.totalMoney-t.totalMoney*(t.coupon.percent/100))))+"\n            ")]):r("span",[t._v("$ "+t._s(t._f("currency")(t.totalMoney)))])])])]),t._v(" "),r("div",{staticClass:"cart-info-products"},[r("h3",[t._v("購買商品")]),t._v(" "),t._l(t.cartData,(function(e){return r("div",{key:e.product.id,staticClass:"cart-info-item"},[r("div",{staticClass:"info"},[r("div",{staticClass:"img"},[r("img",{attrs:{src:e.product.imageUrl}})]),t._v(" "),r("div",{staticClass:"txt"},[r("h5",[t._v(t._s(e.productData.options.winery))]),t._v(" "),r("h4",[t._v(t._s(e.productData.title))]),t._v(" "),r("span",[t._v("\n                "+t._s(e.productData.options.year)+" |\n                "+t._s(e.productData.options.capacity)+" |\n                "+t._s(e.productData.category)+"\n              ")])])]),t._v(" "),r("div",{staticClass:"quantity"},[r("span",[t._v("x "+t._s(e.quantity))]),t._v(" "),r("span",[t._v("$ "+t._s(t._f("currency")(e.quantity*e.product.price)))])])])}))],2)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cart-form-btn"},[e("button",{staticClass:"btn",attrs:{type:"submit"}},[this._v("\n                確認付款\n              ")])])}],!1,null,null,null);e.default=component.exports}}]);